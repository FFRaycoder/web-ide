/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
(function(){var e=["vs/css!vs/github1s/notification","vs/github1s/notification","require","exports","vs/css!vs/code/browser/workbench/workbench","vs/code/browser/workbench/workbench","vs/workbench/workbench.web.api","vs/base/common/uri","vs/base/common/event","vs/base/common/uuid","vs/base/common/cancellation","vs/base/common/buffer","vs/base/common/lifecycle","vs/base/parts/request/browser/request","vs/platform/windows/common/windows","vs/base/common/resources","vs/base/browser/browser","vs/nls!vs/code/browser/workbench/workbench","vs/base/common/network","vs/platform/product/common/product","vs/platform/log/common/log","vs/github1s/util"],t=function(t){for(var o=[],i=0,s=t.length;i<s;i++)o[i]=e[t[i]];return o};define(e[0],t([4]),{}),define(e[1],t([2,3,0]),(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderNotification=void 0;const o=`${[{title:"ATTENTION: This page is NOT officially provided by GitHub.",
content:"GitHub1s is an open source project, which is not officially provided by GitHub.",link:"https://github.com/conwnet/github1s"},{title:`<a class="notification-link" href="${(()=>window.location.pathname.match(/^\/[^\/]+\/[^\/]+/)?`https://gitpod.io/#https://github.com${window.location.pathname.match(/^\/[^\/]+\/[^\/]+/)[0]}`:"")()}" alt="Gitpod ready-to-code" target="_blank"><img src="https://img.shields.io/badge/Gitpod-ready--to--code-blue?logo=gitpod"></a>`,content:"Click the button above to develop your project in the cloud."
}].map(e=>`\n\t\t<div class="notification-main">\n\t\t\t<div class="notification-title">${e.title}</div>\n\t\t\t<div class="notification-content">\n\t\t\t\t${e.content}\n\t\t\t\t${e.link?`<a class="notification-link" href="${e.link}" target="_blank">See more</a>`:""}\n\t\t\t</div>\n\t\t</div>`)}\n<div class="notification-footer">\n\t<button class="notification-confirm-button">OK</button>\n\t<div class="notification-show-me-again">\n\t\t<input type="checkbox" checked>Don't show me again</div>\n\t</div>\n</div>\n`;t.renderNotification=()=>{if(!window.localStorage||"20210212"===window.localStorage.getItem("GITHUB1S_NOTIFICATION"))return;const e=document.createElement("div");e.classList.add("github1s-notification"),e.innerHTML=o,document.body.appendChild(e),e.querySelector(".notification-confirm-button").onclick=()=>{!!e.querySelector(".notification-show-me-again input").checked&&window.localStorage.setItem("GITHUB1S_NOTIFICATION","20210212"),document.body.removeChild(e)}}})),
define(e[5],t([2,3,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,1]),(function(e,t,o,i,s,n,r,a,c,l,d,h,u,p,w,v,f,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const b=()=>[{id:"github1s.vscode.get-browser-url",handler:m.getBrowserUrl},{id:"github1s.vscode.replace-browser-url",handler:m.replaceBrowserUrl}];function E(e,t){let o=void 0;if(t){let e=0;t.forEach((t,i)=>{o||(o="");const s=0==e++?"":"&";o+=`${s}${i}=${encodeURIComponent(t)}`})}return i.URI.parse(window.location.href).with({path:e,query:o})}class R{constructor(){let e;const t=document.getElementById("vscode-workbench-auth-session"),o=t?t.getAttribute("data-settings"):void 0;if(o)try{e=JSON.parse(o)}catch(e){}e&&(this.setPassword(`${v.default.urlProtocol}.login`,"account",JSON.stringify(e)),this.authService=`${v.default.urlProtocol}-${e.providerId}.login`,this.setPassword(this.authService,"account",JSON.stringify(e.scopes.map(t=>({id:e.id,scopes:t,accessToken:e.accessToken})))))}get credentials(){if(!this._credentials){try{
const e=window.localStorage.getItem(R.CREDENTIALS_OPENED_KEY);e&&(this._credentials=JSON.parse(e))}catch(e){}Array.isArray(this._credentials)||(this._credentials=[])}return this._credentials}save(){window.localStorage.setItem(R.CREDENTIALS_OPENED_KEY,JSON.stringify(this.credentials))}async getPassword(e,t){return this.doGetPassword(e,t)}async doGetPassword(e,t){for(const o of this.credentials)if(o.service===e&&("string"!=typeof t||t===o.account))return o.password;return null}async setPassword(e,t,o){this.doDeletePassword(e,t),this.credentials.push({service:e,account:t,password:o}),this.save();try{if(o&&e===this.authService){const t=JSON.parse(o);Array.isArray(t)&&0===t.length&&await this.logout(e)}}catch(e){console.log(e)}}async deletePassword(e,t){const o=await this.doDeletePassword(e,t);if(o&&e===this.authService)try{await this.logout(e)}catch(e){console.log(e)}return o}async doDeletePassword(e,t){let o=!1;return this._credentials=this.credentials.filter(i=>i.service!==e||i.account!==t||(o=!0,!1)),
o&&this.save(),o}async findPassword(e){return this.doGetPassword(e)}async findCredentials(e){return this.credentials.filter(t=>t.service===e).map(({account:e,password:t})=>({account:e,password:t}))}async logout(e){const t=new Map;t.set("logout",String(!0)),t.set("service",e),await l.request({url:E("/auth/logout",t).toString(!0)},r.CancellationToken.None)}}R.CREDENTIALS_OPENED_KEY="credentials.provider";class U extends c.Disposable{constructor(){super(...arguments),this._onCallback=this._register(new s.Emitter),this.onCallback=this._onCallback.event}create(e){const t=new Map,o=n.generateUuid();t.set(U.QUERY_KEYS.REQUEST_ID,o);const{scheme:i,authority:s,path:r,query:a,fragment:c}=e||{scheme:void 0,authority:void 0,path:void 0,query:void 0,fragment:void 0};return i&&t.set(U.QUERY_KEYS.SCHEME,i),s&&t.set(U.QUERY_KEYS.AUTHORITY,s),r&&t.set(U.QUERY_KEYS.PATH,r),a&&t.set(U.QUERY_KEYS.QUERY,a),c&&t.set(U.QUERY_KEYS.FRAGMENT,c),this.periodicFetchCallback(o,Date.now()),E("/callback",t)}async periodicFetchCallback(e,t){
const o=new Map;o.set(U.QUERY_KEYS.REQUEST_ID,e);const s=await l.request({url:E("/fetch-callback",o).toString(!0)},r.CancellationToken.None),n=await a.streamToBuffer(s.stream);if(n.byteLength>0)try{this._onCallback.fire(i.URI.revive(JSON.parse(n.toString())))}catch(e){console.error(e)}else Date.now()-t<U.FETCH_TIMEOUT&&setTimeout(()=>this.periodicFetchCallback(e,t),U.FETCH_INTERVAL)}}U.FETCH_INTERVAL=500,U.FETCH_TIMEOUT=3e5,U.QUERY_KEYS={REQUEST_ID:"vscode-requestId",SCHEME:"vscode-scheme",AUTHORITY:"vscode-authority",PATH:"vscode-path",QUERY:"vscode-query",FRAGMENT:"vscode-fragment"};class _{constructor(e,t){this.workspace=e,this.payload=t}async open(e,t){if((null==t?void 0:t.reuse)&&!t.payload&&this.isSame(this.workspace,e))return;const o=this.createTargetUrl(e,t);o&&((null==t?void 0:t.reuse)?window.location.href=o:u.isStandalone?window.open(o,"_blank","toolbar=no"):window.open(o))}createTargetUrl(e,t){let o=void 0
;return e?d.isFolderToOpen(e)?o=`${document.location.origin}${document.location.pathname}?${_.QUERY_PARAM_FOLDER}=${encodeURIComponent(e.folderUri.toString())}`:d.isWorkspaceToOpen(e)&&(o=`${document.location.origin}${document.location.pathname}?${_.QUERY_PARAM_WORKSPACE}=${encodeURIComponent(e.workspaceUri.toString())}`):o=`${document.location.origin}${document.location.pathname}?${_.QUERY_PARAM_EMPTY_WINDOW}=true`,(null==t?void 0:t.payload)&&(o+=`&${_.QUERY_PARAM_PAYLOAD}=${encodeURIComponent(JSON.stringify(t.payload))}`),o}isSame(e,t){return e&&t?d.isFolderToOpen(e)&&d.isFolderToOpen(t)?h.isEqual(e.folderUri,t.folderUri):!(!d.isWorkspaceToOpen(e)||!d.isWorkspaceToOpen(t))&&h.isEqual(e.workspaceUri,t.workspaceUri):e===t}hasRemote(){if(this.workspace){if(d.isFolderToOpen(this.workspace))return this.workspace.folderUri.scheme===w.Schemas.vscodeRemote;if(d.isWorkspaceToOpen(this.workspace))return this.workspace.workspaceUri.scheme===w.Schemas.vscodeRemote}return!0}}_.QUERY_PARAM_EMPTY_WINDOW="ew",
_.QUERY_PARAM_FOLDER="folder",_.QUERY_PARAM_WORKSPACE="workspace",_.QUERY_PARAM_PAYLOAD="payload";class y{constructor(e){this.onDidChange=s.Event.None;let t=void 0,o=void 0;if(e){let s=void 0;d.isFolderToOpen(e)?s=e.folderUri:d.isWorkspaceToOpen(e)&&(s=e.workspaceUri),"github1s"===(null==s?void 0:s.scheme)&&([t="conwnet",o="github1s"]=i.URI.parse(m.getBrowserUrl()).path.split("/").filter(Boolean))}o&&t?(this.label=p.localize(0,null,t,o),this.tooltip=p.localize(1,null,t,o)):(this.label=p.localize(2,null),this.tooltip=p.localize(3,null))}}!function(){const e=document.getElementById("vscode-workbench-web-configuration"),t=e?e.getAttribute("data-settings"):void 0;if(!e||!t)throw new Error("Missing web configuration element");const s=JSON.parse(t);Array.isArray(s.staticExtensions)&&s.staticExtensions.forEach(e=>{e.extensionLocation=i.URI.revive(e.extensionLocation)});let n,r=!1,a=Object.create(null),c=void 0;new URL(document.location.href).searchParams.forEach((e,t)=>{switch(t){case _.QUERY_PARAM_FOLDER:n={
folderUri:i.URI.parse(e)},r=!0;break;case _.QUERY_PARAM_WORKSPACE:n={workspaceUri:i.URI.parse(e)},r=!0;break;case _.QUERY_PARAM_EMPTY_WINDOW:n=void 0,r=!0;break;case _.QUERY_PARAM_PAYLOAD:try{a=JSON.parse(e)}catch(e){console.error(e)}break;case"logLevel":c=e}}),r||(n=s.folderUri?{folderUri:i.URI.revive(s.folderUri)}:s.workspaceUri?{workspaceUri:i.URI.revive(s.workspaceUri)}:void 0);const l=new _(n,a),[d="conwnet",h="github1s"]=(i.URI.parse(window.location.href).path||"").split("/").filter(Boolean),u={href:`https://github.com/${d}/${h}`,icon:"github",title:p.localize(4,null)};let w=void 0;l.hasRemote()||(w=new y(n));const v=s.settingsSyncOptions?{enabled:s.settingsSyncOptions.enabled,enablementHandler:e=>{let t=`settingsSync=${e?"true":"false"}`;new URL(document.location.href).searchParams.forEach((e,o)=>{"settingsSync"!==o&&(t+=`&${o}=${e}`)}),window.location.href=`${window.location.origin}?${t}`}}:void 0;o.create(document.body,Object.assign(Object.assign({},s),{commands:b(),
logLevel:c?f.parseLogLevel(c):void 0,settingsSyncOptions:v,homeIndicator:u,windowIndicator:w,productQualityChangeHandler:e=>{let t=`quality=${e}`;new URL(document.location.href).searchParams.forEach((e,o)=>{"quality"!==o&&(t+=`&${o}=${e}`)}),window.location.href=`${window.location.origin}?${t}`},workspaceProvider:l,urlCallbackProvider:new U,credentialsProvider:new R})),setTimeout(()=>g.renderNotification(),1e3)}()}))}).call(this);
//# sourceMappingURL=workbench.js.map
